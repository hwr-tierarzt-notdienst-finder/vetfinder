# Where to start?

If you are a German speaker or have the time to use translation tools 
then the sequence diagram [`docs/de_sequence_diagram.puml`](../docs/de_sequence_diagram.puml)
provides a good overview the main backend logic and interactions with frontend services.

Another good place to look are the [end-to-end-tests](tests/test_end_to_end.py). 
Trying to understand and break them may provide you with some insights.

Of course, you can also dive straight into reading the source code. We have tried to order
the following list of modules in order of importance for understanding core functionality.
Working through the list somewhat chronologically me be a good way to start.

# Modules
| name              | description                                                                                                                                                                                                                                                                                                                                                |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| vet_management    | Groups business logic creating/overwriting/deleting vet data and marking vet data as valid or invalid (i.e. deciding whether it should be displayed to the app user) and authorizing from-website and content management users access to preform these operations                                                                                          |
| api               | Implementiert die API-Endpunkte mithilfe von FastAPI                                                                                                                                                                                                                                                                                                       |
| models            | Pydantic models. Currently mainly used to represent vet data in a form that is compatible with database documents, API-requests and responses                                                                                                                                                                                                              |
| config            | Provides access to global configuration. `config.get()` returns a nested configuration singleton. Configuration for various parts of the system can be accessed through attributes, e.g. `config.get().email.smtp_server_username`                                                                                                                         |
| normalization     | Normalization functionality                                                                                                                                                                                                                                                                                                                                |
| normalization.vet | Normalization functionality for vet models                                                                                                                                                                                                                                                                                                                 |
| email_            | Sends emails using an external SMTP-server. The contents of the emails are defined in json template files -> see `email_/templates`                                                                                                                                                                                                                        |
| availability      | Can ingest `AvailabilityCondition` models and use them to calculated a list of non-overlapping timespans between a lower and upper bound. The techniques used here are very similar to boolean logic                                                                                                                                                       |
| auth              | Base logic for authenticating and authorizing access based on JWTs                                                                                                                                                                                                                                                                                         |
| vet_visibility    | The system groups database collections by independent "visibilities". Currently there are 2 visibilities: `public` and `test`. This modules the file `backend/vet_visibility_tokens.txt` containing JWTs for each visibility. These tokens are stored as environment variables in the frontend and form-website services and used some requests to the API |
| db                | Provides a data abstraction layer for managing MongoDB documents and collections. Currently only manages vet data. All other data is currently ephemeral -> caches and JWTs                                                                                                                                                                                |
| paths             | Provides access to globally important filesystem paths                                                                                                                                                                                                                                                                                                     |
| env               | Utilities for determining which environment the backend is running in. Currently `prod`, `dev` or `test`                                                                                                                                                                                                                                                   |
| types_            | Custom global types                                                                                                                                                                                                                                                                                                                                        |
| constants         | Custom global constants                                                                                                                                                                                                                                                                                                                                    |
| utils             | General utilities that are not tied to any system specific implementation details                                                                                                                                                                                                                                                                          |
| logs              | Utilities for creating loggers and log messages that will be saved in files in `/backend/logs`.                                                                                                                                                                                                                                                            |